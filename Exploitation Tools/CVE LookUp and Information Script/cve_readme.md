# CVE Lookup and Information Script

A Python script for querying CVE (Common Vulnerabilities and Exposures) information from the National Vulnerability Database (NVD) API. This tool allows security researchers, developers, and system administrators to quickly lookup vulnerability details, search for CVEs by keywords, and monitor recent vulnerability publications.

## Features

- **Single CVE Lookup**: Get detailed information about a specific CVE by ID
- **Keyword Search**: Search for CVEs using keywords (e.g., "apache", "log4j", "wordpress")
- **Recent CVEs**: Retrieve recently published vulnerabilities within a specified timeframe
- **Multiple Output Formats**: Display results in human-readable text or JSON format
- **CVSS Scoring**: Shows CVSS v2, v3.0, and v3.1 scores when available
- **Reference Links**: Displays official references and advisory links
- **Input Validation**: Validates CVE ID formats and handles API errors gracefully
- **Rate Limiting Awareness**: Handles NVD API rate limits appropriately

## Installation

### Prerequisites

- Python 3.6 or higher
- Internet connection (for API access)

### Dependencies

This script uses only Python standard library modules, so no additional packages need to be installed:

- `argparse` - Command-line argument parsing
- `json` - JSON data handling  
- `urllib` - HTTP requests
- `datetime` - Date/time operations
- `re` - Regular expressions (for CVE ID validation)

### Setup

1. Download the script:
```bash
wget https://example.com/cve_lookup.py
# or
curl -O https://example.com/cve_lookup.py
```

2. Make it executable:
```bash
chmod +x cve_lookup.py
```

## Usage

### Basic CVE Lookup

Look up a specific CVE by ID:
```bash
python cve_lookup.py CVE-2021-44228
```

### JSON Output

Get CVE information in JSON format:
```bash
python cve_lookup.py CVE-2021-44228 --format json
```

### Keyword Search

Search for CVEs containing specific keywords:
```bash
python cve_lookup.py --search "apache log4j"
python cve_lookup.py --search "wordpress" --limit 20
```

### Recent CVEs

Get recently published CVEs:
```bash
# CVEs from last 7 days
python cve_lookup.py --recent 7

# CVEs from last 30 days, limit to 5 results
python cve_lookup.py --recent 30 --limit 5
```

### Verbose Output

Enable detailed logging:
```bash
python cve_lookup.py CVE-2021-44228 --verbose
```

## Command-Line Arguments

### Required Arguments (choose one):
- `cve_id` - CVE ID to lookup (e.g., CVE-2021-44228)
- `--search`, `-s` - Search CVEs by keyword
- `--recent`, `-r` - Get CVEs published in the last N days

### Optional Arguments:
- `--format`, `-f` - Output format: `text` (default) or `json`
- `--limit`, `-l` - Limit number of results (default: 10)
- `--verbose`, `-v` - Enable verbose output

## Output Format

### Text Format (Default)
```
CVE ID: CVE-2021-44228
Published: 2021-12-10T10:15:09.227
Last Modified: 2021-12-29T17:15:12.283
Description: Apache Log4j2 2.0-beta9 through 2.15.0 (excluding security releases 2.12.2, 2.12.3, and 2.3.1) JNDI features used in configuration, log messages, and parameters do not protect against attacker controlled LDAP and other JNDI related endpoints...
CVSS v3.1 Score: 10.0 (CRITICAL)
References:
  - https://logging.apache.org/log4j/2.x/security.html
  - https://www.apache.org/dist/logging/log4j/2.15.0/
  ...
```

### JSON Format
Complete CVE data structure as returned by the NVD API, formatted for readability.

## API Information

This script uses the National Vulnerability Database (NVD) REST API v2.0:
- **Base URL**: https://services.nvd.nist.gov/rest/json/cves/2.0
- **Rate Limits**: Public API allows up to 5 requests per 30-second window
- **Documentation**: https://nvd.nist.gov/developers/vulnerabilities

## Error Handling

The script handles various error conditions:
- **Invalid CVE Format**: Validates CVE-YYYY-NNNN format
- **Network Errors**: Handles connection timeouts and network issues
- **HTTP Errors**: 404 (not found), 429 (rate limit), etc.
- **JSON Parsing**: Handles malformed API responses
- **API Rate Limits**: Provides informative error messages

## Limitations

- **Rate Limiting**: Public NVD API has usage limits (5 requests per 30 seconds)
- **Data Freshness**: CVE data depends on NVD update frequency
- **Search Limitations**: Keyword search uses NVD's search algorithm
- **Historical Data**: Some older CVEs may have limited information

## Security Considerations

- This tool is for **legitimate security research and defense only**
- CVE information should be used to **patch and protect systems**
- Do not use vulnerability information for malicious purposes
- Respect the NVD API terms of service and rate limits

## Ethical Use

This script is intended for:
- ✅ Vulnerability assessment and management
- ✅ Security research and analysis
- ✅ Compliance and audit activities
- ✅ Educational purposes
- ✅ Defensive security operations

This script should NOT be used for:
- ❌ Unauthorized penetration testing
- ❌ Exploiting vulnerabilities in systems you don't own
- ❌ Any malicious or illegal activities

## Contributing

Feel free to submit issues, feature requests, or pull requests to improve this tool.

## License

MIT License

Copyright (c) 2024 CVE Lookup Script

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Changelog

### Version 1.0.0
- Initial release
- CVE lookup by ID
- Keyword search functionality
- Recent CVE retrieval
- Text and JSON output formats
- Comprehensive error handling

## Support

For questions, issues, or suggestions:
- Check the NVD API documentation: https://nvd.nist.gov/developers
- Review common CVE ID formats: https://cve.mitre.org/cve/identifiers/
- Understand CVSS scoring: https://www.first.org/cvss/
