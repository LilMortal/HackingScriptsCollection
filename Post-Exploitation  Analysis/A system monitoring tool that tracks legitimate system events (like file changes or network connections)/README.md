# System Monitor Tool

A comprehensive Python-based system monitoring tool designed for security awareness and system administration. This tool tracks legitimate system events including file system changes, network connections, process monitoring, and system resource usage.

## Description

The System Monitor Tool is an educational and practical utility that helps administrators and security professionals understand system activity by monitoring various aspects of system behavior. It provides real-time logging of system events and can be used for:

- **Security Monitoring**: Track file changes, new network connections, and process activities
- **System Administration**: Monitor resource usage and system performance
- **Forensic Analysis**: Log system events for later analysis
- **Educational Purposes**: Learn about system monitoring and security practices

## Features

- **File System Monitoring**: Real-time tracking of file creation, modification, deletion, and movement
- **Network Connection Monitoring**: Detection of new network connections with process identification
- **Process Monitoring**: Tracking of new process creation and termination
- **Resource Monitoring**: System resource usage including CPU, memory, disk, and network statistics
- **Flexible Configuration**: Monitor specific components or all system events
- **Persistent Logging**: Optional file-based logging for event history
- **Cross-Platform Support**: Works on Windows, macOS, and Linux
- **Graceful Shutdown**: Proper cleanup on termination signals

## Installation

### Prerequisites

- Python 3.6 or higher
- Administrator/root privileges (recommended for full system monitoring)

### Dependencies

The script requires the following Python packages:

```bash
pip install psutil watchdog
```

#### Dependency Details:

- **psutil**: For system and process utilities (network, processes, resources)
- **watchdog**: For file system event monitoring (optional, but recommended)

### Installation Steps

1. **Clone or download the script**:
   ```bash
   # Download the script file
   wget https://example.com/system_monitor.py
   # or copy the script to your local machine
   ```

2. **Install dependencies**:
   ```bash
   pip install psutil watchdog
   ```

3. **Make the script executable** (Linux/macOS):
   ```bash
   chmod +x system_monitor.py
   ```

4. **Verify installation**:
   ```bash
   python system_monitor.py --help
   ```

## Usage

### Basic Usage

Monitor all system events for 5 minutes:
```bash
python system_monitor.py --monitor-all --duration 300
```

### Specific Monitoring Options

**File System Monitoring**:
```bash
# Monitor specific directories
python system_monitor.py --monitor-files --watch-paths /home/user/documents /tmp

# Monitor current directory
python system_monitor.py --monitor-files
```

**Network Monitoring**:
```bash
python system_monitor.py --monitor-network --verbose
```

**Process Monitoring**:
```bash
python system_monitor.py --monitor-processes --log-file process_events.log
```

**Resource Monitoring**:
```bash
python system_monitor.py --monitor-resources --duration 3600
```

### Advanced Usage Examples

**Comprehensive Security Monitoring**:
```bash
python system_monitor.py --monitor-all --log-file security_audit.log --verbose
```

**Targeted File Monitoring with Logging**:
```bash
python system_monitor.py --monitor-files --watch-paths /etc /home/user/.ssh --log-file file_changes.log
```

**Network Security Monitoring**:
```bash
python system_monitor.py --monitor-network --monitor-processes --duration 7200 --log-file network_security.log
```

## Command Line Arguments

### Monitoring Options
- `--monitor-all`: Monitor all system events (files, network, processes, resources)
- `--monitor-files`: Monitor file system changes
- `--monitor-network`: Monitor network connections
- `--monitor-processes`: Monitor process creation and termination
- `--monitor-resources`: Monitor system resource usage

### Configuration Options
- `--watch-paths PATH [PATH ...]`: Specify paths to monitor for file changes
- `--duration SECONDS`: Duration to monitor in seconds (default: indefinite)
- `--log-file FILE`: Path to log file for persistent logging
- `--verbose`: Enable verbose console output

### Usage Examples Built-in Help
```bash
python system_monitor.py --help
```

## Output Format

The tool generates timestamped log entries in the following formats:

### File System Events
```
2025-06-22 10:30:15 - FILE_CREATED: /path/to/new_file.txt
2025-06-22 10:30:16 - FILE_MODIFIED: /path/to/existing_file.txt
2025-06-22 10:30:17 - FILE_DELETED: /path/to/deleted_file.txt
```

### Network Events
```
2025-06-22 10:30:18 - NEW_CONNECTION: 192.168.1.100:54321 -> 93.184.216.34:443 (Process: firefox, PID: 1234)
```

### Process Events
```
2025-06-22 10:30:19 - NEW_PROCESS: PID=5678, Name=python3, Command=/usr/bin/python3 script.py
2025-06-22 10:30:20 - PROCESS_TERMINATED: PID=5678
```

### Resource Usage
```
2025-06-22 10:30:21 - RESOURCE_USAGE: CPU=15.2%, Memory=67.8%, Disk=45.3%, Network_In=1048576, Network_Out=524288
```

## Platform-Specific Notes

### Linux
- Requires appropriate permissions for process monitoring
- Some network monitoring features may require root privileges
- File system monitoring works with inotify

### macOS
- File system monitoring uses FSEvents
- Process monitoring may require additional permissions in newer macOS versions
- Network monitoring works with standard user privileges

### Windows
- File system monitoring uses ReadDirectoryChangesW
- Administrator privileges recommended for full functionality
- Some process information may be limited based on user privileges

## Security Considerations

### Ethical Use
This tool is designed for legitimate system monitoring purposes only:
- ✅ **Authorized system administration**
- ✅ **Security auditing of your own systems**
- ✅ **Educational and research purposes**
- ✅ **Compliance monitoring**
- ❌ **Unauthorized monitoring of systems you don't own**
- ❌ **Surveillance without proper authorization**
- ❌ **Violating privacy or terms of service**

### Privacy and Legal Compliance
- Ensure you have proper authorization before monitoring any system
- Be aware of local privacy laws and regulations
- Consider data retention policies for logged information
- Use appropriate file permissions for log files containing sensitive information

### Best Practices
- Run with minimal required privileges when possible
- Regularly rotate and secure log files
- Monitor the monitoring system itself for integrity
- Document monitoring activities for compliance purposes

## Limitations

- **Performance Impact**: Intensive monitoring may affect system performance
- **Permission Requirements**: Some features require elevated privileges
- **Platform Differences**: Feature availability may vary between operating systems
- **Resource Usage**: Continuous monitoring consumes CPU and memory resources
- **Log File Size**: Long-running sessions can generate large log files

## Troubleshooting

### Common Issues

**"watchdog library not found"**:
```bash
pip install watchdog
```

**Permission denied errors**:
- Run with sudo/administrator privileges
- Check file permissions for watch directories
- Verify access to system process information

**High CPU usage**:
- Increase monitoring intervals by modifying sleep times in the code
- Reduce the number of monitored paths
- Use duration limits instead of indefinite monitoring

**Log file issues**:
- Ensure write permissions for log file directory
- Check available disk space
- Verify log file path is accessible

### Debug Mode
Enable verbose output for troubleshooting:
```bash
python system_monitor.py --monitor-all --verbose
```

## Development and Customization

The script is designed to be easily extensible. Key areas for customization:

- **Monitoring Intervals**: Adjust sleep times in monitoring loops
- **Event Filtering**: Add filters to reduce noise in logs
- **Additional Monitors**: Extend with new monitoring classes
- **Output Formats**: Modify logging formats or add structured output (JSON, XML)
- **Alerting**: Add notification systems for specific events

## Contributing

This is an educational tool. Suggestions for improvements:
- Additional monitoring capabilities
- Better cross-platform compatibility
- Performance optimizations
- Enhanced security features
- Documentation improvements

## License

MIT License

Copyright (c) 2025 System Monitor Tool

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Support

For issues, questions, or contributions, please refer to the documentation or create an issue in the project repository.

## Disclaimer

This tool is provided for educational and legitimate system administration purposes. Users are responsible for ensuring their use of this tool complies with applicable laws, regulations, and organizational policies. The authors assume no responsibility for misuse of this software.
