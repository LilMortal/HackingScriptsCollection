# Process Hunter - Suspicious Process Detection Tool

A comprehensive Python-based security tool designed to monitor running processes and identify potentially suspicious activity on Windows, Linux, and macOS systems. This tool helps security analysts, system administrators, and cybersecurity professionals detect malware, crypto miners, and other malicious processes.

## Features

- **Comprehensive Process Scanning**: Analyze all running processes for suspicious indicators
- **Real-time Monitoring**: Continuously monitor for new suspicious processes
- **Multiple Detection Methods**:
  - Suspicious process names and file extensions
  - Crypto mining software detection
  - System processes running from non-standard locations
  - High resource usage detection
  - Suspicious network connections
  - Excessive file handle usage
- **Flexible Analysis**: Analyze specific processes by PID
- **Export Capabilities**: Export results to JSON or CSV formats
- **Cross-platform Support**: Works on Windows, Linux, and macOS
- **Detailed Logging**: Comprehensive logging with configurable levels

## Installation

### Prerequisites

- Python 3.6 or higher
- Administrative/root privileges (recommended for full process access)

### Dependencies

Install the required Python packages:

```bash
pip install psutil
```

Or install from the requirements file:

```bash
pip install -r requirements.txt
```

### Download and Setup

1. Clone or download the script:
```bash
git clone <repository-url>
cd process-hunter
```

2. Make the script executable (Linux/macOS):
```bash
chmod +x process_hunter.py
```

## Usage

### Basic Commands

#### Scan All Processes
Perform a one-time scan of all running processes:
```bash
python process_hunter.py --scan-all
```

#### Monitor Processes
Continuously monitor for suspicious processes:
```bash
python process_hunter.py --monitor
```

#### Monitor with Custom Interval
Monitor every 60 seconds for 1 hour:
```bash
python process_hunter.py --monitor --interval 60 --duration 3600
```

#### Analyze Specific Process
Analyze a specific process by PID:
```bash
python process_hunter.py --pid 1234
```

#### Detailed Analysis
Get detailed information about processes:
```bash
python process_hunter.py --scan-all --detailed
```

### Advanced Usage

#### Export Results
Export scan results to JSON:
```bash
python process_hunter.py --scan-all --export results.json
```

Export to CSV format:
```bash
python process_hunter.py --scan-all --export results.csv
```

#### Custom Logging
Set custom logging level:
```bash
python process_hunter.py --scan-all --log-level DEBUG
```

### Command-Line Arguments

| Argument | Description |
|----------|-------------|
| `--scan-all` | Scan all running processes for suspicious activity |
| `--monitor` | Continuously monitor for suspicious processes |
| `--pid PID` | Analyze a specific process by PID |
| `--interval SECONDS` | Monitoring interval in seconds (default: 30) |
| `--duration SECONDS` | Total monitoring duration in seconds |
| `--export FILENAME` | Export results to file (JSON/CSV) |
| `--detailed` | Show detailed analysis output |
| `--log-level LEVEL` | Set logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL) |

## Detection Criteria

The tool identifies suspicious processes based on several criteria:

### 1. Suspicious Process Names
- Processes with suspicious file extensions (.tmp, .scr, .bat, .vbs, .js)
- Known crypto mining software names
- Randomly generated process names
- System processes running from non-system locations

### 2. Resource Usage Patterns
- High CPU usage (>80% by default)
- High memory usage (>80% by default)
- Excessive file handles (>1000)

### 3. Network Activity
- Excessive network connections (>50 active connections)
- Connections to suspicious ports (6667, 6668, 6669, 1337, 31337, 4444, 5555)

### 4. System Process Verification
- Windows system processes (svchost.exe, lsass.exe, etc.) running from non-system directories

## Output Examples

### Scan Results
```
============================================================
SUSPICIOUS PROCESSES DETECTED: 2
============================================================

PID: 1234
Name: xmrig.exe
Executable: C:\Users\temp\xmrig.exe
Alerts: Potential crypto mining software: xmr

PID: 5678
Name: suspicious.tmp
Executable: C:\temp\suspicious.tmp
Alerts: Suspicious file extension: .tmp
```

### Monitoring Output
```
2024-06-22 10:30:15 - __main__ - WARNING - New suspicious process: cryptominer.exe (PID: 9876)
2024-06-22 10:30:45 - __main__ - WARNING - Suspicious process detected: malware.scr (PID: 4321)
```

## Export Formats

### JSON Export
```json
{
  "scan_timestamp": "2024-06-22T10:30:00",
  "total_processes": 156,
  "suspicious_processes": 2,
  "results": [
    {
      "pid": 1234,
      "name": "suspicious.exe",
      "exe": "/path/to/suspicious.exe",
      "suspicious": true,
      "alerts": ["Suspicious name: random process name"],
      "cpu_percent": 85.2,
      "memory_percent": 45.1
    }
  ]
}
```

### CSV Export
```csv
PID,Name,Executable,Suspicious,Alerts,CPU%,Memory%
1234,suspicious.exe,/path/to/suspicious.exe,True,Suspicious name: random process name,85.2,45.1
```

## Security Considerations

### Ethical Use
This tool is designed for legitimate security analysis and system monitoring purposes only. Users must:
- Only use this tool on systems they own or have explicit permission to monitor
- Comply with all applicable local, state, and federal laws
- Respect privacy and confidentiality requirements
- Use the tool responsibly and ethically

### Limitations
- **False Positives**: The tool may flag legitimate processes as suspicious
- **Access Restrictions**: Some processes may not be accessible without elevated privileges
- **Platform Differences**: Detection effectiveness may vary between operating systems
- **Evasion Techniques**: Advanced malware may use techniques to avoid detection

### Recommendations
- Run with administrative/root privileges for complete process access
- Regularly update the suspicious indicators list
- Combine with other security tools for comprehensive protection
- Review and validate all alerts before taking action

## Troubleshooting

### Common Issues

1. **Permission Denied Errors**
   - Run the script with elevated privileges (sudo on Linux/macOS, Run as Administrator on Windows)

2. **Missing Dependencies**
   - Install required packages: `pip install psutil`

3. **No Processes Detected**
   - Check if the script has sufficient permissions
   - Verify that processes are actually running

4. **High False Positive Rate**
   - Adjust detection thresholds in the script
   - Customize the suspicious indicators for your environment

## Contributing

Contributions are welcome! Please consider:
- Adding new detection methods
- Improving cross-platform compatibility
- Enhancing performance
- Adding new export formats
- Improving documentation

## License

MIT License

Copyright (c) 2024 Process Hunter Contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Changelog

### Version 1.0.0
- Initial release
- Basic process scanning functionality
- Real-time monitoring capabilities
- JSON and CSV export support
- Cross-platform compatibility
- Comprehensive logging system

## Disclaimer

This tool is provided for educational and legitimate security analysis purposes. The authors are not responsible for any misuse or damage caused by this software. Users are solely responsible for ensuring compliance with applicable laws and regulations.

## Support

For issues, questions, or contributions, please:
1. Check the troubleshooting section
2. Review existing documentation
3. Create an issue with detailed information about your problem
4. Provide system information and error messages when reporting bugs

---

**Note**: This tool is designed to assist security professionals and system administrators. Always verify suspicious processes through multiple sources before taking any action.
