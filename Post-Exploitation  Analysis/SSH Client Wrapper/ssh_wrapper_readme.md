# SSH Client Wrapper

A secure and user-friendly Python wrapper for SSH client operations, designed for legitimate remote system administration tasks.

## Description

This script provides a comprehensive SSH client interface with enhanced security features, proper error handling, and logging capabilities. It supports both password and key-based authentication, command execution, and file transfers over SSH.

## Features

- **Secure Authentication**: Support for both password and SSH key authentication
- **Command Execution**: Execute commands on remote servers with safety checks
- **File Transfer**: Upload and download files using SFTP
- **Input Validation**: Prevents execution of potentially dangerous commands
- **Comprehensive Logging**: Detailed logging with multiple verbosity levels
- **Error Handling**: Robust error handling with informative messages
- **Timeout Support**: Configurable connection and command timeouts
- **Host Validation**: Checks hostname reachability before connection attempts

## Installation

### Prerequisites

- Python 3.6 or higher
- pip (Python package manager)

### Dependencies

Install the required dependencies:

```bash
pip install paramiko
```

Alternatively, if you have a `requirements.txt` file:

```bash
pip install -r requirements.txt
```

### Manual Installation

1. Clone or download the script
2. Make it executable (on Unix-like systems):
   ```bash
   chmod +x ssh_client_wrapper.py
   ```

## Usage

### Basic Syntax

```bash
python ssh_client_wrapper.py -H <hostname> -u <username> [options]
```

### Authentication Options

You must choose one authentication method:

- `-p, --password`: Use password authentication (will prompt securely)
- `-k, --key PATH`: Use SSH key authentication with specified key file

### Common Options

- `-H, --hostname`: Remote hostname or IP address (required)
- `-u, --username`: Username for authentication (required)
- `--port`: SSH port (default: 22)
- `--timeout`: Connection timeout in seconds (default: 30)
- `-v, --verbose`: Enable verbose logging

### Examples

#### Execute a Command with Password Authentication

```bash
python ssh_client_wrapper.py -H server.example.com -u admin -p -c "uptime"
```

#### Execute a Command with SSH Key

```bash
python ssh_client_wrapper.py -H 192.168.1.100 -u root -k ~/.ssh/id_rsa -c "df -h"
```

#### Upload a File

```bash
python ssh_client_wrapper.py -H server.com -u user -p --upload /local/config.txt /etc/config.txt
```

#### Download a File

```bash
python ssh_client_wrapper.py -H server.com -u user -k ~/.ssh/id_rsa --download /var/log/app.log ./app.log
```

#### Verbose Output

```bash
python ssh_client_wrapper.py -H server.com -u admin -p -c "ps aux" -v
```

#### Custom Port and Timeout

```bash
python ssh_client_wrapper.py -H server.com --port 2222 --timeout 60 -u admin -p -c "systemctl status nginx"
```

### Command Line Arguments

| Argument | Description | Required |
|----------|-------------|----------|
| `-H, --hostname` | Remote hostname or IP address | Yes |
| `-u, --username` | Username for authentication | Yes |
| `-p, --password` | Use password authentication | One of -p or -k |
| `-k, --key PATH` | Path to private key file | One of -p or -k |
| `-c, --command` | Command to execute on remote server | No |
| `--upload LOCAL REMOTE` | Upload file from local to remote path | No |
| `--download REMOTE LOCAL` | Download file from remote to local path | No |
| `--port` | SSH port (default: 22) | No |
| `--timeout` | Connection timeout in seconds (default: 30) | No |
| `-v, --verbose` | Enable verbose logging | No |

## Security Features

### Safety Checks

The script includes several safety mechanisms:

- **Command Filtering**: Blocks potentially dangerous commands (e.g., `rm -rf /`, `mkfs`, `shutdown`)
- **Host Validation**: Verifies hostname reachability before connection attempts
- **File Permission Checks**: Validates SSH key file permissions and accessibility
- **Input Validation**: Sanitizes and validates all user inputs
- **Secure Password Input**: Uses `getpass` to hide password input

### Authentication Security

- Supports secure SSH key-based authentication
- Password authentication uses secure prompting
- Host key verification with auto-add policy (can be customized)
- Connection timeouts to prevent hanging connections

## Error Handling

The script provides comprehensive error handling for:

- Network connectivity issues
- Authentication failures
- Invalid hostnames or file paths
- SSH protocol errors
- File transfer errors
- Command execution timeouts

## Logging

The script uses Python's built-in logging module with the following levels:

- **INFO**: Connection status, command execution, file transfers
- **ERROR**: Authentication failures, connection errors, command failures
- **DEBUG**: Detailed debugging information (enabled with `-v` flag)

## Limitations

- Host key verification uses `AutoAddHostKeyPolicy` (automatically accepts new host keys)
- Some dangerous commands are blocked for safety
- Requires `paramiko` library for SSH functionality
- File transfers use SFTP protocol only

## Ethical Use and Warnings

### ⚠️ Important Security Considerations

- **Authorized Use Only**: Only use this tool on systems you own or have explicit permission to access
- **Credential Security**: Never store passwords in scripts or command history
- **Network Security**: Use this tool only on trusted networks
- **Key Management**: Protect SSH private keys with appropriate file permissions (600 or 400)
- **Audit Trail**: Monitor and log all remote access activities

### Legal Compliance

- Ensure compliance with your organization's security policies
- Follow all applicable laws and regulations regarding system access
- Obtain proper authorization before accessing remote systems
- Maintain appropriate documentation of system access

### Best Practices

1. Use SSH key authentication instead of passwords when possible
2. Regularly rotate SSH keys and passwords
3. Monitor connection logs for suspicious activity
4. Use the principle of least privilege for user accounts
5. Keep the script and dependencies updated

## Troubleshooting

### Common Issues

**"paramiko not found" Error**
```bash
pip install paramiko
```

**"Permission denied (publickey)" Error**
- Verify SSH key file exists and has correct permissions
- Ensure the public key is added to the remote server's `authorized_keys`
- Check that the username is correct

**"Connection timeout" Error**
- Verify the hostname and port are correct
- Check network connectivity
- Ensure SSH service is running on the remote server
- Try increasing the timeout value

**"Host key verification failed" Error**
- The script uses `AutoAddHostKeyPolicy` to handle new host keys
- For production use, consider implementing stricter host key verification

## Contributing

When contributing to this project:

1. Follow PEP 8 Python style guidelines
2. Add appropriate error handling and logging
3. Include docstrings for all functions and classes
4. Test thoroughly with different authentication methods
5. Ensure security best practices are maintained

## License

MIT License

Copyright (c) 2024 SSH Client Wrapper Contributors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

## Support

For support and questions:

1. Check the troubleshooting section above
2. Review the paramiko documentation for SSH-specific issues
3. Ensure all security best practices are being followed
4. Verify system permissions and network connectivity

---

**Note**: This tool is designed for legitimate system administration purposes. Always ensure you have proper authorization before accessing remote systems.
