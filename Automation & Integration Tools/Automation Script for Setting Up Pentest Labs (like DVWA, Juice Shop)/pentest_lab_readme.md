# Pentest Lab Setup Automation Script

A comprehensive Python script for automating the setup of penetration testing laboratory environments. This tool creates isolated, containerized environments with intentionally vulnerable applications for educational and authorized security research purposes.

## ⚠️ IMPORTANT WARNING

**This script creates intentionally vulnerable environments for educational and authorized testing purposes only. Always use in isolated networks and never expose these labs to production environments or public networks.**

## Features

- **Multiple Lab Types**: Web application, network security, wireless, and mobile security labs
- **Containerized Deployment**: Uses Docker and Docker Compose for easy management
- **Automated Configuration**: Generates all necessary configuration files and scripts
- **Comprehensive Documentation**: Auto-generates lab documentation and access instructions
- **Network Isolation**: Creates isolated networks for safe testing
- **Management Scripts**: Includes start, stop, and status scripts for easy lab management

## Prerequisites

### Required Dependencies
- **Python 3.6+** - Main scripting language
- **Docker** - Container runtime (REQUIRED)
- **Docker Compose** - Multi-container management (usually included with Docker)

### Optional Dependencies
- **Vagrant** - For VM-based labs (future feature)
- **VirtualBox** - Virtualization platform (future feature)

## Installation

### 1. Clone or Download the Script

Save the `pentest_lab_setup.py` script to your desired directory.

### 2. Install Python Dependencies

The script uses only Python standard libraries, so no additional Python packages are required.

### 3. Install Docker

#### Ubuntu/Debian:
```bash
sudo apt update
sudo apt install docker.io docker-compose
sudo systemctl start docker
sudo systemctl enable docker
sudo usermod -aG docker $USER
```

#### CentOS/RHEL:
```bash
sudo yum install docker docker-compose
sudo systemctl start docker
sudo systemctl enable docker
sudo usermod -aG docker $USER
```

#### macOS:
Download and install Docker Desktop from https://docker.com

#### Windows:
Download and install Docker Desktop from https://docker.com

**Note**: You may need to log out and back in after adding your user to the docker group.

### 4. Verify Installation

```bash
docker --version
docker-compose --version
python3 --version
```

## Usage

### Basic Usage

```bash
# Make the script executable
chmod +x pentest_lab_setup.py

# Create a web application security lab
./pentest_lab_setup.py --lab-type web --name "WebApp-Lab"

# Create a network security lab with verbose output
./pentest_lab_setup.py --lab-type network --name "Network-Lab" --verbose

# Create a lab in a custom directory
./pentest_lab_setup.py --lab-type web --name "CustomLab" --output /path/to/custom/directory
```

### Available Lab Types

```bash
# List all available lab templates
./pentest_lab_setup.py --list-templates
```

#### Web Application Security Lab (`web`)
- **DVWA** (Damn Vulnerable Web Application)
- **WebGoat** - OWASP's vulnerable web application
- **Mutillidae II** - Deliberately vulnerable web application
- **MySQL Database** - Backend database
- **Network**: 192.168.100.0/24

#### Network Security Lab (`network`)
- **Metasploitable 2/3** - Intentionally vulnerable Linux
- **Vulnerable SSH Server** - Misconfigured SSH service
- **Various Network Services** - FTP, Telnet, HTTP, SMB
- **Network**: 192.168.200.0/24

#### Wireless Security Lab (`wireless`)
- **Software Access Point** - Hostapd configuration
- **Aircrack-ng Suite** - Wireless security tools
- **Test Networks** - WPA/WPA2 vulnerable configurations
- **Network**: 192.168.300.0/24

#### Mobile Security Lab (`mobile`)
- **Android Emulators** - Virtual mobile devices
- **DIVA** - Damn Insecure Vulnerable App
- **Frida Server** - Dynamic instrumentation
- **Network**: 192.168.400.0/24

## Command-Line Options

```
usage: pentest_lab_setup.py [-h] [--lab-type {web,network,wireless,mobile}]
                           [--name NAME] [--output OUTPUT] [--list-templates]
                           [--verbose] [--version]

optional arguments:
  -h, --help            show this help message and exit
  --lab-type {web,network,wireless,mobile}
                        Type of penetration testing lab to create
  --name NAME           Name for the lab (will be used as directory name)
  --output OUTPUT       Output directory for lab files (default: ./pentest_labs)
  --list-templates      List available lab templates and exit
  --verbose, -v         Enable verbose output
  --version             show program's version number and exit
```

## Lab Management

After creating a lab, you'll find the following structure:

```
YourLabName/
├── docker-compose.yml          # Main container configuration
├── lab_metadata.json          # Lab information and metadata
├── configs/                   # Configuration files
├── docker/                    # Docker-related files
├── scripts/                   # Management scripts
│   ├── start_lab.sh          # Start the lab
│   ├── stop_lab.sh           # Stop the lab
│   └── status.sh             # Check lab status
├── documentation/             # Auto-generated documentation
│   ├── lab_overview.md       # Lab overview and setup
│   └── access_instructions.md # How to access services
└── logs/                     # Log files
```

### Starting a Lab

```bash
cd YourLabName
./scripts/start_lab.sh
```

### Checking Lab Status

```bash
./scripts/status.sh
```

### Stopping a Lab

```bash
./scripts/stop_lab.sh
```

## Access Information

### Web Application Lab
- **DVWA**: http://localhost:8080 (admin/password)
- **WebGoat**: http://localhost:8081

### Network Security Lab
- **SSH (Vulnerable)**: localhost:2223 (testuser/vulnerable)
- **Metasploitable Web**: http://localhost:8082
- **Metasploitable SSH**: localhost:2222

## Security Considerations

### ⚠️ Critical Security Notes

1. **Isolation Required**: Always run labs in isolated environments
2. **No Public Exposure**: Never expose lab services to public networks
3. **Authorized Use Only**: Only use on networks you own or have explicit permission to test
4. **Regular Updates**: Keep Docker images updated for latest vulnerable versions
5. **Clean Shutdown**: Always stop labs when not in use
6. **Monitor Resources**: Labs can consume significant system resources

### Network Security

- All labs use isolated Docker networks
- Services are only accessible via localhost by default
- Default credentials are intentionally weak for testing purposes
- Firewall rules should restrict access to lab networks

## Troubleshooting

### Common Issues

#### Docker Permission Errors
```bash
# Add user to docker group and restart session
sudo usermod -aG docker $USER
# Log out and back in, then test:
docker ps
```

#### Port Conflicts
If you encounter port conflicts, modify the `docker-compose.yml` file in your lab directory to use different ports.

#### Container Start Failures
```bash
# Check container logs
docker-compose logs

# Check system resources
docker system df
docker system prune  # Clean up if needed
```

#### Permission Issues
```bash
# Fix script permissions
chmod +x scripts/*.sh
```

### Getting Help

1. Check the generated documentation in your lab's `documentation/` folder
2. Use the `--verbose` flag for detailed output
3. Check Docker and container logs for specific error messages

## Development and Customization

### Adding New Lab Templates

The script is designed to be easily extensible. To add new lab types:

1. Edit the `_load_lab_templates()` method
2. Add your template configuration
3. Update the `generate_docker_compose()` method for custom services
4. Test thoroughly in an isolated environment

### Contributing

When contributing to this project:

1. Test all changes in isolated environments
2. Update documentation for new features
3. Follow Python PEP 8 style guidelines
4. Include appropriate error handling
5. Verify security implications of changes

## Legal and Ethical Use

### Intended Use
- Educational purposes and learning cybersecurity
- Authorized penetration testing and security research
- Security training and skill development
- Vulnerability research in controlled environments

### Prohibited Use
- Unauthorized access to systems you don't own
- Malicious activities or illegal hacking
- Testing against production systems without authorization
- Circumventing security measures on systems you don't control

### Liability
Users are solely responsible for ensuring their use of this tool complies with applicable laws and regulations. The authors assume no liability for misuse of this tool.

## License

```
MIT License

Copyright (c) 2025 Pentest Lab Setup Project

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

## Changelog

### Version 1.0.0
- Initial release
- Support for web, network, wireless, and mobile lab types
- Docker Compose integration
- Automated documentation generation
- Management script creation
- Comprehensive error handling and validation

## Support and Contact

For issues, suggestions, or contributions:
- Review the troubleshooting section above
- Check existing documentation in generated labs
- Ensure you're following ethical use guidelines

---

**Remember: With great power comes great responsibility. Use these tools ethically and legally.**